# Agent Notes 04

## 1) Summary
- Simplified the user creation form to only require display name with optional bio.
- Auto-generated unique handle from display name to maintain data model consistency.
- Added validation logic to the data abstraction layer for user creation.
- Implemented error handling and display for invalid user inputs.
- Newly created users appear immediately in the users list.

## 2) Decisions & Rationale
- **Auto-generate handle from name:** Since the internal data model requires a handle but the UI specification only mentions display name, I auto-generate a unique handle from the display name. This keeps the data model intact while simplifying the user-facing form.
- **Handle collision resolution:** The `generateHandle` function ensures uniqueness by appending numeric suffixes when collisions occur. This prevents duplicate handles without user intervention.
- **Validation in data layer:** Following the pattern established in Step 03, validation logic lives in `store.js` as `validateUser()`, keeping business rules centralized.
- **Error display:** Similar to comment form, errors are shown inline below the form for consistency.
- **Bio as optional:** Made bio explicitly labeled as optional and removed the required attribute, while location field was removed entirely per requirements.
- **Field limits:** Added reasonable limits (100 chars for name, 500 for bio) to prevent abuse and maintain UI integrity.

## 3) Ambiguities Encountered
- **Handle field requirement**
  - Options considered: (a) require users to input handle, (b) auto-generate from name, (c) use sequential IDs as handle.
  - Resolution: auto-generate from name for better user experience and meaningful handles. Falls back to `user{N}` if name contains no valid characters.

- **Location field**
  - Options considered: (a) keep location as optional, (b) remove entirely.
  - Resolution: removed since requirements only mention display name and bio. Can be re-added in future steps if needed.

- **Handle generation algorithm**
  - Options considered: (a) simple lowercase conversion, (b) slug-style with special char replacement, (c) hash-based.
  - Resolution: chose slug-style (alphanumeric only) with collision detection for readability and uniqueness.

- **What to do with existing seed data**
  - Options considered: (a) update seed.json to remove location, (b) leave as-is.
  - Resolution: left seed data unchanged since the data model still supports location field; only the creation form was simplified.

## 4) Tradeoffs
- **Auto-generated handles vs user control:** Simpler UX but users cannot customize their handle. For a demo app, this is acceptable; production might want both options.
- **Handle uniqueness logic:** Current implementation checks the entire users array on each creationâ€”O(n) lookup. Fine for small datasets but would need optimization for scale.
- **Location field removal:** Simplifies the form but existing users still show location. This creates minor inconsistency between seeded and new users.
- **Validation limits:** Fixed character limits are simple but inflexible. Could be made configurable in future.

## 5) Non-Goals
- Custom handle selection by users.
- Email or authentication fields.
- Avatar upload or customization beyond auto-generated abstract images.
- Username uniqueness validation during typing (only checked on submit).
- Profile editing capabilities.
- Deleting or archiving users.

## 6) Files Changed
- Updated: [src/components/UserForm.vue](../../src/components/UserForm.vue)
- Updated: [src/data/store.js](../../src/data/store.js)
- Updated: [src/views/UsersView.vue](../../src/views/UsersView.vue)
- Added: [docs/agent-notes/04.md](04.md)

## 7) Manual Verification Checklist
- Run `npm run dev` and navigate to the Users page.
- Try to submit an empty display name and verify error message appears.
- Enter a display name longer than 100 characters and verify rejection.
- Enter a bio longer than 500 characters and verify rejection.
- Create a user with only a display name (no bio) and confirm it appears in the list.
- Create a user with both display name and bio and verify both fields are saved.
- Create two users with the same display name and verify unique handles are generated.
- Verify new users appear immediately without page refresh.
- Check that new users have abstract avatar images.

## 8) Known Issues / Follow-ups
- New users don't have a location field, while seeded users do. This creates visual inconsistency in user cards.
- Auto-generated handles might not be intuitive (e.g., "John Smith" becomes "johnsmith" or "johnsmith1").
- No character counter to help users stay within limits before submitting.
- Handle generation strips all special characters, which might not preserve names from non-Latin scripts well.
- The viewing user selector in the header doesn't automatically update when a new user is created; requires manual selection or page refresh.
