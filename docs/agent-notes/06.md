# Agent Notes 06

## 1) Summary
- Reduced bio character limit from 500 to 160 characters to encourage concise profiles.
- Added live character counter that updates as the user types.
- Implemented visual feedback with three states: normal, warning (≤20 chars remaining), and over limit.
- Applied `maxlength` attribute to prevent typing beyond the limit at the browser level.
- Counter shows current length, max length, and contextual hints for remaining/over characters.

## 2) Decisions & Rationale

**Character limit choice (160):**
The 160-character limit mirrors the classic SMS length and Twitter's original constraint. This length is well-established as sufficient for concise biographical statements while encouraging focused self-description. The limit is short enough to keep profiles scannable but long enough for meaningful expression.

**Live counter implementation:**
Used Vue's computed properties to reactively calculate:
- Current character count (`bioLength`)
- Remaining characters (`bioRemaining`)
- Visual state class (`bioCounterClass`)

This approach is efficient and leverages Vue's reactivity system without manual DOM manipulation.

**Three-tier visual feedback:**
1. **Normal state (gray):** 0-140 characters, subtle counter.
2. **Warning state (orange):** 141-160 characters, alerts user they're approaching the limit.
3. **Over limit state (red):** >160 characters, clear error indication (though maxlength prevents this in practice).

The warning threshold (20 chars before limit) gives users advance notice to adjust their text before hitting the wall.

**maxlength enforcement:**
Applied HTML5 `maxlength` attribute to the textarea as primary enforcement. This prevents users from typing beyond the limit, providing immediate feedback at the browser level. The validation in the data layer serves as a backup for edge cases (paste operations that bypass maxlength, programmatic changes, etc.).

**Counter display format:**
Shows "X / 160" format with contextual hints:
- When under limit but close (≤20 remaining): "(N remaining)"
- When over limit: "(N over)" - though maxlength should prevent this

This dual display (current/max + hint) provides both absolute and relative context.

**Non-trimmed validation:**
Changed validation to check `bio.length` instead of `bio.trim().length`. This is important because:
- Users need to see the limit enforced on what they type, not what will be saved.
- Leading/trailing spaces should count toward the limit for UX clarity.
- The form still trims on submit, but the counter reflects visible characters.

**Positioning and styling:**
Counter is right-aligned below the textarea, following common UX patterns from platforms like Twitter/X. The visual hierarchy (color + weight) ensures the counter is noticeable when important but not distracting when there's ample room.

## 3) Ambiguities Encountered

**When to show warning state:**
- Options considered: (a) only when at/over limit, (b) warning at 80% capacity, (c) warning at fixed threshold (20 chars).
- Resolution: chose fixed threshold of 20 remaining characters as it provides useful early warning without being overly cautious.

**Whether to prevent or just warn about exceeding limit:**
- Options considered: (a) hard limit with maxlength, (b) soft limit with warnings only, (c) allow overflow but block submission.
- Resolution: implemented hard limit via maxlength for immediate feedback, backed by validation. This is the most user-friendly approach - users know clearly where the boundary is.

**Display format for counter:**
- Options considered: (a) "X/160", (b) "160 remaining", (c) "X characters", (d) combination approach.
- Resolution: used "X / 160" as base with contextual hints. This format is familiar from many platforms and shows both progress and limit.

**Where to display the counter:**
- Options considered: (a) above textarea, (b) below textarea, (c) inline with label, (d) floating overlay.
- Resolution: below textarea, right-aligned. This is the conventional location and doesn't interfere with the label or input area.

**Trim behavior in validation:**
- Options considered: (a) validate against trimmed length, (b) validate against full length including whitespace.
- Resolution: validate against full length for counter consistency, but trim when submitting. This ensures WYSIWYG behavior for the user.

## 4) Tradeoffs

**Hard limit vs soft limit:**
- Chose hard limit (maxlength) for clarity and immediate feedback.
- Tradeoff: less flexible, can feel restrictive.
- Benefit: clear boundaries, no surprise validation errors on submit.

**Fixed warning threshold vs percentage:**
- Used fixed 20-character threshold rather than percentage (like 80%).
- Tradeoff: doesn't scale if limit changes, might feel arbitrary.
- Benefit: consistent behavior, simpler mental model.

**Counter always visible vs on-demand:**
- Counter is always visible when bio field is present.
- Tradeoff: adds visual noise even when not needed.
- Benefit: educational—users learn the limit exists before hitting it.

**Validation on length vs trimmed length:**
- Validate on full string length, not trimmed.
- Tradeoff: spaces count toward limit, slightly less efficient storage.
- Benefit: WYSIWYG behavior, no confusion between what user types and what counts.

**Three states vs two:**
- Implemented three visual states (normal/warning/over) instead of two (ok/error).
- Tradeoff: more complex CSS and logic.
- Benefit: progressive disclosure of urgency, better UX.

## 5) Non-Goals

- Character counter for other fields (name, comments).
- Separate limits for different user types or roles.
- Configurable/adjustable character limits.
- Word count instead of character count.
- Internationalization considerations for character counting (grapheme clusters, combining characters).
- Accessibility announcements for counter updates (could spam screen readers).
- Copy editing suggestions or content quality hints.
- Save draft functionality for bios.

## 6) Files Changed
- Updated: [src/data/store.js](../../src/data/store.js)
- Updated: [src/components/UserForm.vue](../../src/components/UserForm.vue)
- Updated: [src/style.css](../../src/style.css)
- Added: [docs/agent-notes/06.md](06.md)

## 7) Manual Verification Checklist
- Run `npm run dev` and navigate to the Users page.
- Begin typing in the bio field and verify the counter updates live.
- Type up to 140 characters and confirm counter shows normal gray color.
- Type between 141-160 characters and verify warning state (orange) appears.
- Verify remaining character hint appears when ≤20 characters remain.
- Try to type beyond 160 characters and confirm the textarea prevents it.
- Try pasting text longer than 160 characters and verify it's truncated.
- Submit a user with exactly 160 characters in bio.
- Submit a user with bio under the limit and verify it saves correctly.
- Check responsive behavior—counter should remain visible and readable on mobile.
- Test with empty bio field to ensure counter shows "0 / 160".

## 8) Known Issues / Follow-ups

**Browser maxlength behavior varies:**
- Some browsers allow pasting beyond maxlength and silently truncate.
- Some browsers block the paste entirely.
- Validation in data layer catches any discrepancies.

**No accessibility announcements:**
- Screen readers don't announce counter updates as user types.
- Could be disruptive if implemented, but might help some users.
- Consider ARIA live region with polite setting if needed.

**International text considerations:**
- Character counting is based on JavaScript string length.
- Some languages use combining characters or multi-byte characters that count as multiple units.
- Emoji with modifiers might count unexpectedly.
- For production, consider using grapheme-aware counting (e.g., Intl.Segmenter).

**Counter doesn't update on programmatic changes:**
- If bio is set programmatically (not currently possible), counter would update due to reactivity.
- No known issues in current implementation.

**Visual overflow with very long single words:**
- If someone types a 160-character string without spaces, it might cause layout issues.
- Textarea word-wrap handles this reasonably well.
- CSS word-break could be added if needed.

**No undo once limit is hit:**
- If users hit the limit, they can't see what they were about to type.
- Browser's built-in undo (Ctrl/Cmd+Z) helps but isn't obvious.
- Could implement a soft limit with truncate button as alternative.

**Warning state might be too subtle:**
- Orange color is noticeable but might not be urgent enough for some users.
- Could add animation or icon if more emphasis is needed.

**Existing seed data not validated:**
- Current seed data has bios under 160 chars so no issues.
- If seed data ever has longer bios, they'd be grandfathered in.
- New users and edits (when implemented) would enforce the limit.

**Counter adds visual noise:**
- Always-visible counter might distract from the field itself.
- Could make it only appear on focus, but that reduces discoverability.
- Current approach prioritizes transparency over minimalism.
